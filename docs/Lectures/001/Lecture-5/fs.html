<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
<HEAD>
    <TITLE>文件系统构造</TITLE>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=gb2312-80">
    <META NAME="COPYRIGHT" CONTENT="魏永明">
    <META NAME="AUTHOR" CONTENT="魏永明">
    <STYLE>
    <!--
        H1 { color: #ffff00 }
        H2 { color: #ffff00 }
        H3 { color: #ff00ff }
        H4 { color: #ffff00 }
        TD P { color: #b880b8 }
        LI { color: #ffffff }
        P { color: #00ffff }
        PRE { color: #ffffff; font-family: "fixed" }
        A:link { color: #00b8ff }
        A:visited { color: #ff3366 }
    -->
    </STYLE>
</HEAD>
<BODY TEXT="#ffff00" LINK="#00b8ff" VLINK="#ff3366" BACKGROUND="images/velvet.jpg">

<A HREF="fileio.html"><IMG SRC="next.gif" ALT="Next"></A>
<A HREF="index.html"><IMG SRC="toc.gif" ALT="Contents"></A>

<H1 ALIGN=CENTER>5.1&nbsp;&nbsp;文件系统构造<BR><BR>
</H1>

<UL>
    <LI><P>基本概念</LI>
    <LI><P>索引节点</LI>
    <LI><P>目录和目录项</LI>
    <LI><P>文件的定位</LI>
    <LI><P>链接</LI>
    <LI><P>文件系统相关系统调用所面临的问题</LI>
</UL>

<H3>5.1.1&nbsp;&nbsp;基本概念</H3>
<UL>
    <LI>UNIX 文件系统与其他操作系统文件系统的不同 (文件类型, 索引节点, 可挂装...).</LI>
    <LI>虚拟文件系统</LI>
    
<P ALIGN=CENTER><IMG SRC="images/fig04-06.gif" ALT=VFS><BR>
图 5-1  Linux 的虚拟文件系统和实际文件系统的关系</P>

</UL>

<H3>5.1.2&nbsp;&nbsp;索引节点</H3>
<UL>
    <LI>概念</LI>
    <LI>Ext2 文件系统的索引节点</LI>

<P ALIGN=CENTER><IMG SRC="images/fig04-13.gif" ALT=inode><BR>
图 5-2  Ext2 文件系统的索引节点</P>

</UL>

<H3>5.1.3&nbsp;&nbsp;目录和目录项</H3>
<UL>
    <LI>目录是一种特殊文件, 其文件内容是该目录中的目录项</LI>

<P ALIGN=CENTER><IMG SRC="images/fig04-04.gif" ALT="directory and inode"><BR>
图 5-3  目录和索引节点之间的关系</P>

    <LI>目录项内容包括索引节点编号, 目录项名称长度以及名称本身</LI>
<P ALIGN=CENTER><IMG SRC="images/fig04-14.gif" ALT="directory entry"><BR>
图 5-4  目录项布局</P>

</UL>

<H3>5.1.4&nbsp;&nbsp;文件的定位</H3>
<UL>
    <LI>见图 5-5 中的例子</LI>

<P ALIGN=CENTER><IMG SRC="images/fig04-15.gif" ALT="locating file"><BR>
图 5-5  文件的定位过程</P>

</UL>

<H3>5.1.5&nbsp;&nbsp;链接</H3>
<UL>
    <LI>如图 5-3 所示, 同一文件系统中, 可以有多个目录项指向同一个索引节点: 硬链接</LI>
    <LI>硬链接缺点</LI>
    <LI>符号链接可以跨文件系统</LI>
</UL>

<H3>5.1.6&nbsp;&nbsp;文件系统相关系统调用所面临的问题</H3>
<UL>
    <LI>基本操作: 打开/关闭, 读取/写入, 目录项信息如何获得, 目录操作...</LI>
    <LI>特殊考虑: 操作是否沿符号链接到达实际文件</LI>
</UL>

<P>
<BR><BR>
</P>

<P ALIGN=CENTER>
<IMG SRC="images/striped.gif" NAME="Ruler" ALIGN=BOTTOM WIDTH=532 HEIGHT=13 BORDER=0></P>

<P>
<BR><BR>
</P>

<A HREF="fileio.html"><IMG SRC="next.gif" ALT="Next"></A>
<A HREF="index.html"><IMG SRC="toc.gif" ALT="Contents"></A>

</BODY>
</HTML>

