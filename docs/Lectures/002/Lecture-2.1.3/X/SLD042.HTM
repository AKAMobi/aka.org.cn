
<!--  Presentation generated by Internet Assistant for Microsoft PowerPoint 97 -->

<HTML>
<HEAD>

<meta name="GENERATOR" content="Microsoft Internet Assistant for Microsoft PowerPoint 97">
 <TITLE>KDE编程: DCOP</TITLE> 
</HEAD>

<BODY     >

<CENTER>
<TABLE WIDTH=100%> 
     <TR> <TD WIDTH=100% ALIGN=CENTER>
         <IMG SRC="img042.gif" usemap="#Objmap" WIDTH=512 HEIGHT=384 BORDER=0>
     </TD> </TR>
     <TR> <TD WIDTH=100% ALIGN=CENTER>
         <A HREF="sld001.htm">First</A>&nbsp;&nbsp;
         <A HREF="sld041.htm">Previous</A>&nbsp;&nbsp;
         <A HREF="sld043.htm">Next</A>&nbsp;&nbsp;
         <A HREF="sld044.htm">Last</A>&nbsp;&nbsp;
&nbsp;&nbsp;         <A HREF="index.htm">Index</A>&nbsp;&nbsp;
         <A HREF="http://www.lisoleg.org">Home</A>&nbsp;&nbsp;
         <A HREF="tsld042.htm">Text</A>&nbsp;&nbsp;
     </TD> </TR>
</TABLE>
<P>Slide 42 of 44</P>
</CENTER>
<!-- <UL>
<H2>KDE编程: DCOP</H2>
</UL></P>
<P><UL>
<LI><H2>DCOP IDL
</H2>
<UL>
class Iface : virtual public DCOPObject
<BR><BR>{  K_DCOP
<BR>	public:
<BR> 	k_dcop:
<BR>   	 virtual void add( QString s ) = 0;
<BR> };
</UL></UL><UL>
<LI><H2>DCOP Servant
</H2>
<UL>
    DCOPClient *client = kapp-&#062dcopClient();
<BR><BR>    client-&#062attach();
<BR>    ByteArray params;
<BR>    QDataStream stream(params, IO_WriteOnly);
<BR>    stream &#060&#060 location-&#062text();
<BR>    if (!client-&#062send("Servant-*", "bookmarkList", "add(QString)", params))
<BR>       kDebugError( "Error with DCOP");
<BR>
</UL></UL><UL>
<LI><H2>DCOP Servant
</H2>
<UL>
   DCOPClient *client=kapp-&#062dcopClient();
<BR><BR>   client-&#062attach();
<BR>   client-&#062registerAs("Servant");
<BR>   void MainList::add( QString s )
<BR>	{ insertItem ( new QListViewItem ( this , s ) );	}; </UL></UL></P>
<P><UL>
<LI> Marshaller
</UL><UL>

</UL><UL>
bool BookmarkList::process(const QCString &fun, const QByteArray &data,
</UL><UL>
		        QCString &replyType, QByteArray &replyData)
</UL><UL>
{
</UL><UL>
  if (fun == "add(QString)") {
</UL><UL>
    QDataStream arg(data, IO_ReadOnly);
</UL><UL>
    int i; // parameter
</UL><UL>
    arg &#062&#062 i;
</UL><UL>
    QString result = self-&#062add (i);
</UL><UL>
    QDataStream reply(replyData, IO_WriteOnly);
</UL><UL>
    reply &#060&#060 result;
</UL><UL>
    replyType = "QString";
</UL><UL>
    return true;
</UL><UL>
  } else {	return false;  }
</UL><UL>
}</UL></P>
<P>  -->
</Body>
</HTML>
